// Модуль служебных функций
// Содержит вспомогательные функции для работы со строками и данными

#Область ПрограммныйИнтерфейс

// Преобразует строку в верхний регистр
//
// Параметры:
//  ИсходнаяСтрока - Строка - строка для преобразования
//
// Возвращаемое значение:
//  Строка - строка в верхнем регистре
//
Функция ВВерхнийРегистр(ИсходнаяСтрока) Экспорт
    Возврат ВРег(ИсходнаяСтрока);
КонецФункции

// Преобразует строку в нижний регистр
//
// Параметры:
//  ИсходнаяСтрока - Строка - строка для преобразования
//
// Возвращаемое значение:
//  Строка - строка в нижнем регистре
//
Функция ВНижнийРегистр(ИсходнаяСтрока) Экспорт
    Возврат НРег(ИсходнаяСтрока);
КонецФункции

// Удаляет пробелы в начале и конце строки
//
// Параметры:
//  ИсходнаяСтрока - Строка - строка для обработки
//
// Возвращаемое значение:
//  Строка - строка без начальных и конечных пробелов
//
Функция УбратьПробелы(ИсходнаяСтрока) Экспорт
    Возврат СокрЛП(ИсходнаяСтрока);
КонецФункции

// Проверяет, является ли значение числом
//
// Параметры:
//  Значение - Произвольный - значение для проверки
//
// Возвращаемое значение:
//  Булево - Истина, если значение является числом
//
Функция ЭтоЧисло(Значение) Экспорт
    Возврат ТипЗнч(Значение) = Тип("Число");
КонецФункции

// Проверяет корректность email адреса
//
// Параметры:
//  Email - Строка - email адрес для проверки
//
// Возвращаемое значение:
//  Булево - Истина, если email корректен
//
Функция ПроверитьEmail(Email) Экспорт

    Если ПустаяСтрока(Email) Тогда
        Возврат Ложь;
    КонецЕсли;

    ПозицияСобаки = СтрНайти(Email, "@");
    Если ПозицияСобаки = 0 Тогда
        Возврат Ложь;
    КонецЕсли;

    ПозицияТочки = СтрНайти(Email, ".", , ПозицияСобаки);
    Возврат ПозицияТочки > ПозицияСобаки + 1;

КонецФункции

// Записывает сообщение в лог
//
// Параметры:
//  Сообщение - Строка - текст сообщения
//  Уровень - Строка - уровень важности: "информация", "предупреждение", "ошибка"
//
Процедура ЗаписатьВЛог(Сообщение, Уровень = "информация") Экспорт

    ТекущееВремя = ТекущаяДата();
    ФорматВремени = Формат(ТекущееВремя, "ДФ='yyyy-MM-dd HH:mm:ss'");

    ПолноеСообщение = "[" + ФорматВремени + "] [" + ВРег(Уровень) + "] " + Сообщение;

    Если Уровень = "ошибка" Тогда
        Сообщить(ПолноеСообщение, СтатусСообщения.Важное);
    ИначеЕсли Уровень = "предупреждение" Тогда
        Сообщить(ПолноеСообщение, СтатусСообщения.Внимание);
    Иначе
        Сообщить(ПолноеСообщение, СтатусСообщения.Информация);
    КонецЕсли;

КонецПроцедуры

// Создает резервную копию данных
//
// Параметры:
//  ИсходныеДанные - Произвольный - данные для копирования
//
// Возвращаемое значение:
//  Произвольный - копия данных
//
Функция СоздатьРезервнуюКопию(ИсходныеДанные) Экспорт

    Если ТипЗнч(ИсходныеДанные) = Тип("Структура") Тогда
        Копия = Новый Структура;
        Для Каждого КлючИЗначение Из ИсходныеДанные Цикл
            Копия.Вставить(КлючИЗначение.Ключ, КлючИЗначение.Значение);
        КонецЦикла;
        Возврат Копия;
    ИначеЕсли ТипЗнч(ИсходныеДанные) = Тип("Массив") Тогда
        Копия = Новый Массив;
        Для Каждого Элемент Из ИсходныеДанные Цикл
            Копия.Добавить(Элемент);
        КонецЦикла;
        Возврат Копия;
    Иначе
        Возврат ИсходныеДанные;
    КонецЕсли;

КонецФункции

// Проверяет наличие элемента в массиве
//
// Параметры:
//  Массив - Массив - массив для поиска
//  Элемент - Произвольный - искомый элемент
//
// Возвращаемое значение:
//  Булево - Истина, если элемент найден
//
Функция СодержитЭлемент(МассивДанных, ИскомыйЭлемент) Экспорт

    Для Каждого ТекущийЭлемент Из МассивДанных Цикл
        Если ТекущийЭлемент = ИскомыйЭлемент Тогда
            Возврат Истина;
        КонецЕсли;
    КонецЦикла;

    Возврат Ложь;

КонецФункции

#КонецОбласти
